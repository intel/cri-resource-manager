apiVersion: v1
kind: Pod
metadata:
  name: ${NAME}
  labels:
    app: ${NAME}
  $([ -n "${!ANN*}" ] && echo "
  annotations:
    $(for ann in ${!ANN*}; do [[ "$ann" == ANN[0-9]* ]] && echo "
    ${!ann}
    "; done)
  ")
spec:
  containers:
  $(for contnum in $(seq 1 ${CONTCOUNT}); do echo "
  - name: ${NAME}c$(( contnum - 1 ))
    image: ${MEME_IMAGE}
    imagePullPolicy: IfNotPresent
    command:
      - meme
      - -bs
      - \"${MEME_BS:-1G}\"
      - -brc
      - \"${MEME_BRC:-0}\"
      - -brs
      - \"${MEME_BRS:-0M}\"
      - -bwc
      - \"${MEME_BWC:-0}\"
      - -bws
      - \"${MEME_BWS:-0M}\"
      - -ttl
      - \"${MEME_TTL:-1h}\"
  "; done )
  terminationGracePeriodSeconds: 1
